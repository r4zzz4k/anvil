<head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Contributing - Inkremental</title> <link rel="shortcut icon" href="https://inkremental.r4zzz4k.me/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://inkremental.r4zzz4k.me/assets/css/just-the-docs.css"> <script type="text/javascript" src="https://inkremental.r4zzz4k.me/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://inkremental.r4zzz4k.me/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Contributing | Inkremental</title> <meta name="generator" content="Jekyll v4.0.1" /> <meta property="og:title" content="Contributing" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Reactive library for Android UI using native components." /> <meta property="og:description" content="Reactive library for Android UI using native components." /> <link rel="canonical" href="https://inkremental.r4zzz4k.me/contributing.html" /> <meta property="og:url" content="https://inkremental.r4zzz4k.me/contributing.html" /> <meta property="og:site_name" content="Inkremental" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://inkremental.r4zzz4k.me/assets/images/logo.png"}},"headline":"Contributing","url":"https://inkremental.r4zzz4k.me/contributing.html","description":"Reactive library for Android UI using native components.","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="https://inkremental.r4zzz4k.me" class="site-title lh-tight"> <div class="site-logo"></div> Inkremental </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="https://inkremental.r4zzz4k.me/" class="navigation-list-link">Home</a></li><li class="navigation-list-item"><a href="https://inkremental.r4zzz4k.me/under-the-hood/" class="navigation-list-link">Under the hood</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://inkremental.r4zzz4k.me/under-the-hood/core-principles.html" class="navigation-list-link">Core principles</a></li><li class="navigation-list-item "><a href="https://inkremental.r4zzz4k.me/under-the-hood/code-generation.html" class="navigation-list-link">Code generation</a></li><li class="navigation-list-item "><a href="https://inkremental.r4zzz4k.me/under-the-hood/customization.html" class="navigation-list-link">Customization</a></li></ul></li><li class="navigation-list-item active"><a href="https://inkremental.r4zzz4k.me/contributing.html" class="navigation-list-link active">Contributing</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Inkremental" aria-label="Search Inkremental" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0 mr-2"><a href="https://t.me/inkremental">Telegram</a></li> <li class="d-inline-block my-0 mr-2"><a href="https://kotlinlang.slack.com/messages/inkremental">Slack</a></li> <li class="d-inline-block my-0"><a href="//github.com/inkremental/inkremental">GitHub</a></li> </ul> </div> <div class="page"> <a class="gh-edit" href="https://github.com/r4zzz4k/inkremental/edit/master/docs/contributing.md">Edit this page</a> <div id="main-content" class="page-content" role="main"> <h1 id="building"> <a href="#building" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Building </h1> <ol> <li>You should have Android SDK installed.</li> <li>Make sure you have Android SDK Platforms 15, 19, 21, 28 installed.</li> <li>Provide either environment variable called <code class="highlighter-rouge">ANDROID_HOME</code> or <code class="highlighter-rouge">local.properties</code> with <code class="highlighter-rouge">sdk.dir</code> pointing to Android SDK root.</li> <li>Run <code class="highlighter-rouge">./generateDsl.sh</code></li> </ol> <p>If you have <code class="highlighter-rouge">PATH</code> set up properly, you can run the following commands to ensure Android SDK is ready:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sdkmanager <span class="nt">--licenses</span>
<span class="c"># Accept everything needed if you agree with terms</span>
sdkmanager <span class="se">\</span>
    <span class="s2">"platforms;android-15"</span> <span class="se">\</span>
    <span class="s2">"platforms;android-19"</span> <span class="se">\</span>
    <span class="s2">"platforms;android-21"</span> <span class="se">\</span>
    <span class="s2">"platforms;android-28"</span> <span class="se">\</span>
    <span class="s2">"build-tools;28.0.3"</span> <span class="se">\</span>
    <span class="s2">"extras;android;m2repository"</span> <span class="se">\</span>
    <span class="s2">"platform-tools"</span> <span class="se">\</span>
    <span class="s2">"tools"</span>
</code></pre></div></div> <h1 id="adding-new-libraries"> <a href="#adding-new-libraries" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Adding new libraries </h1> <p>Every Gradle module provides publications for any number of libraries. Let’s walk through this by an example.</p> <p>Suppose we want to generate bindings for the library called <code class="highlighter-rouge">androidx.teapot</code>, versions <code class="highlighter-rouge">1.2.0</code> and <code class="highlighter-rouge">1.2.4</code>. We declare new Inkremental module as follows:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">inkremental</span> <span class="p">{</span>
    <span class="nf">androidLibrary</span><span class="p">(</span><span class="s">"androidx-teapot"</span><span class="p">,</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"1.2.0"</span><span class="p">,</span> <span class="s">"1.2.4"</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">..</span><span class="p">.</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Let’s say that this snippet belongs to the build script of Gradle subproject called <code class="highlighter-rouge">inkremental-teapot</code>.</p> <p>This creates two Inkremental modules: <code class="highlighter-rouge">androidxTeapot-1.2.0</code> and <code class="highlighter-rouge">androidxTeapot-1.2.4</code>. They both have own Android flavors with dimension called <code class="highlighter-rouge">dev.inkremental.variant.inkremental-teapot</code>.</p> <p>For these modules we would have following source sets:</p> <ul> <li><code class="highlighter-rouge">src/main/kotlin</code></li> <li><code class="highlighter-rouge">src/androidxTeapot/kotlin</code></li> <li><code class="highlighter-rouge">src/androidxTeapot-1/kotlin</code></li> <li><code class="highlighter-rouge">src/androidxTeapot-1.2/kotlin</code></li> <li><code class="highlighter-rouge">src/androidxTeapot-1.2.4/kotlin</code></li> <li><code class="highlighter-rouge">src/androidxTeapot-1.2.5/kotlin</code></li> <li><code class="highlighter-rouge">src/gen-androidxTeapot-1.2.4/kotlin</code></li> <li><code class="highlighter-rouge">src/gen-androidxTeapot-1.2.5/kotlin</code></li> </ul> <p>All but last four are common for these two libraries. This can be helpful if libraries follow semantic versioning and you have some custom code that can be shared for different versions with the same major or minor component.</p> <p>Last two source sets will contain automatically generated code.</p> <p>We would similarily have following Gradle configurations:</p> <ul> <li><code class="highlighter-rouge">inkremental</code></li> <li><code class="highlighter-rouge">androidxTeapotInkremental</code></li> <li><code class="highlighter-rouge">androidxTeapot-1Inkremental</code></li> <li><code class="highlighter-rouge">androidxTeapot-1.2Inkremental</code></li> <li><code class="highlighter-rouge">androidxTeapot-1.2.4Inkremental</code></li> <li><code class="highlighter-rouge">androidxTeapot-1.2.5Inkremental</code></li> </ul> <p>These can be used to declare dependencies on other Inkremental modules.</p> <ul> <li><code class="highlighter-rouge">inkrementalGen</code></li> <li><code class="highlighter-rouge">androidxTeapotInkrementalGen</code></li> <li><code class="highlighter-rouge">androidxTeapot-1InkrementalGen</code></li> <li><code class="highlighter-rouge">androidxTeapot-1.2InkrementalGen</code></li> <li><code class="highlighter-rouge">androidxTeapot-1.2.4InkrementalGen</code></li> <li><code class="highlighter-rouge">androidxTeapot-1.2.5InkrementalGen</code></li> </ul> <p>These configurations are used to collect artifacts for code generator processing.</p> <p>All the custom code like your own attributes and setters that you have can be placed in any of source sets mentioned above. To run this process on our sample library, you would declare something along those lines:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">dependencies</span> <span class="p">{</span>
    <span class="s">"inkremental"</span><span class="p">(</span><span class="s">"dev.inkremental.androidx.heater:heater:1.6.1@json"</span><span class="p">)</span>
    <span class="s">"androidxHeater-1.6.1InkrementalGen"</span><span class="p">(</span><span class="s">"androidx.heater:heater:1.6.1"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div> <p>If you’d like to declare dependency on another Inkremental module within the same project, instead of that you’ll have the following:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">android</span> <span class="p">{</span>
	<span class="nf">defaultConfig</span> <span class="p">{</span>
		<span class="nf">missingDimensionStrategy</span><span class="p">(</span><span class="s">"dev.inkremental.variant.inkremental-heater"</span><span class="p">,</span> <span class="s">"androidxHeater-1.6.1"</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="nf">dependencies</span> <span class="p">{</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="nf">project</span><span class="p">(</span><span class="s">":inkremental-heater"</span><span class="p">))</span>
    <span class="s">"inkremental"</span><span class="p">(</span><span class="nf">project</span><span class="p">(</span><span class="s">":inkremental-heater"</span><span class="p">,</span> <span class="s">"androidxHeater-1.6.1InkrementalDef"</span><span class="p">))</span>
    <span class="s">"androidxHeater-1.6.1InkrementalGen"</span><span class="p">(</span><span class="s">"androidx.heater:heater:1.6.1"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div> <p>Don’t forget to add your project to the root <code class="highlighter-rouge">settings.gradle.kts</code> and mention it in root <code class="highlighter-rouge">build.gradle.kts</code> so that common build and publish tasks would catch it.</p> <h1 id="publishing"> <a href="#publishing" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Publishing </h1> <p>Metadata for publishing is mostly declared at root <code class="highlighter-rouge">gradle.properties</code> file. To publish artifacts to repository, you should declare following environment variables:</p> <ul> <li><code class="highlighter-rouge">BINTRAY_USER</code>: username of Bintray account.</li> <li><code class="highlighter-rouge">BINTRAY_API_KEY</code>: API key for Bintray, can be found <a href="https://bintray.com/profile/edit">in profile settings</a>.</li> <li><code class="highlighter-rouge">BINTRAY_REPO</code> <em>(optional)</em>: overrides repo declared in properties file, can be used to test publishing with different Maven repository.</li> </ul> <h1 id="notes"> <a href="#notes" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Notes </h1> <ul> <li>To disable code generation on every build, you can run Gradle with the following parameter: <code class="highlighter-rouge">-PdontGenerateCodeOnBuild=true</code>. You can also add <code class="highlighter-rouge">dontGenerateCodeOnBuild=true</code> to your <code class="highlighter-rouge">local.properties</code> as a permanent solution. <strong>Please</strong> don’t forget to disable this flag when preparing PR.</li> </ul> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 Inkremental contributors. Distributed by an <a href="https://github.com/inkremental/inkremental/tree/master/LICENSE">Apache 2.0 license.</a></p> </footer> </div> </div> </div> </div> </body> </html>
